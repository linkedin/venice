package com.linkedin.venice.utils;

import com.linkedin.security.ssl.access.control.SSLEngineComponentFactory;
import com.linkedin.security.ssl.access.control.SSLEngineComponentFactoryImpl;
import com.linkedin.venice.exceptions.VeniceException;
import com.linkedin.venice.helix.HelixInstanceConverter;
import com.linkedin.venice.meta.Instance;
import com.linkedin.venice.meta.OfflinePushStrategy;
import com.linkedin.venice.meta.PersistenceType;
import com.linkedin.venice.meta.ReadStrategy;
import com.linkedin.venice.meta.RoutingStrategy;
import com.linkedin.venice.meta.Store;
import java.util.concurrent.TimeUnit;
import java.util.function.BooleanSupplier;
import javax.validation.constraints.NotNull;

import com.linkedin.venice.offsets.OffsetRecord;
import org.apache.helix.HelixManager;
import org.apache.helix.HelixManagerFactory;
import org.apache.helix.InstanceType;
import org.apache.helix.participant.statemachine.StateModel;
import org.apache.helix.participant.statemachine.StateModelFactory;
import org.apache.kafka.clients.consumer.OffsetAndMetadata;


/**
 * General-purpose utility functions for tests.
 */
public class TestUtils {
  /** In milliseconds */
  private static final int WAIT_TIME_FOR_NON_DETERMINISTIC_ACTIONS = 30;

  public static String getUniqueString(String base) {
    return base + "-" + System.currentTimeMillis() + "-" + RandomGenUtils.getRandomIntWithIn(Integer.MAX_VALUE);
  }

  /**
   * To be used for tests when we need to wait for an async operation to complete.  Pass a timeout, and a labmda
   * for checking if the operation is complete.
   *
   * @param timeout amount of time to wait
   * @param timeoutUnits {@link TimeUnit} for the {@param timeout}
   * @param conditionToWaitFor A {@link BooleanSupplier} which should execute the non-deterministic action and
   *                           return true if it is successful, false otherwise.
   */
  public static void waitForNonDeterministicCompletion(long timeout, TimeUnit timeoutUnits, BooleanSupplier conditionToWaitFor){
    long timeoutTime = System.currentTimeMillis() + timeoutUnits.toMillis(timeout);
    while (!conditionToWaitFor.getAsBoolean()){
      if (System.currentTimeMillis() > timeoutTime){
        throw new RuntimeException("Operation did not complete in time");
      }
      Utils.sleep(WAIT_TIME_FOR_NON_DETERMINISTIC_ACTIONS);
    }
  }

  /**
   * To be used for tests when we need to wait for an async operation to complete. Pass a timeout, and a labmda
   * for checking if the operation is complete.
   *
   * @param timeout amount of time to wait
   * @param timeoutUnits {@link TimeUnit} for the {@param timeout}
   * @param assertionToWaitFor A {@link NonDeterministicAssertion} which should simply execute without exception
   *                           if it is successful, or throw an {@link AssertionError} otherwise.
   * @throws AssertionError throws the exception thrown by the {@link NonDeterministicAssertion} if the maximum
   *                        wait time has been exceeded.
   */
  public static void waitForNonDeterministicAssertion(long timeout,
                                                      TimeUnit timeoutUnits,
                                                      NonDeterministicAssertion assertionToWaitFor) throws AssertionError {
    long timeoutTime = System.currentTimeMillis() + timeoutUnits.toMillis(timeout);
    while (true) {
      try {
        assertionToWaitFor.execute();
        return;
      } catch (AssertionError ae) {
        if (System.currentTimeMillis() > timeoutTime) {
          throw ae;
        }
        Utils.sleep(WAIT_TIME_FOR_NON_DETERMINISTIC_ACTIONS);
      }
    }
  }

  public static Store createTestStore(@NotNull String name, @NotNull String owner, long createdTime) {
      return new Store(name, owner, createdTime, PersistenceType.IN_MEMORY, RoutingStrategy.CONSISTENT_HASH,
          ReadStrategy.ANY_OF_ONLINE, OfflinePushStrategy.WAIT_ALL_REPLICAS);
  }

  public interface NonDeterministicAssertion {
    void execute() throws AssertionError;
  }

  public static HelixManager getParticipant(String cluster, String nodeId, String zkAddress, int httpPort, String stateModelDef) {
    MockTestStateModelFactory stateModelFactory = new MockTestStateModelFactory();
    return getParticipant(cluster, nodeId, zkAddress, httpPort, stateModelFactory, stateModelDef);
  }

  public static HelixManager getParticipant(String cluster, String nodeId, String zkAddress, int httpPort,
      StateModelFactory<StateModel> stateModelFactory, String stateModelDef) {
    HelixManager participant =
        HelixManagerFactory.getZKHelixManager(cluster, nodeId, InstanceType.PARTICIPANT, zkAddress);
    participant.getStateMachineEngine()
        .registerStateModelFactory(stateModelDef,
            stateModelFactory);
    participant.setLiveInstanceInfoProvider(
        () -> HelixInstanceConverter.convertInstanceToZNRecord(new Instance(nodeId, Utils.getHostName(), httpPort)));
    return participant;
  }

  public static OffsetRecord getOffsetRecord(long offset) {
    return getOffsetRecord(offset, false);
  }

  public static OffsetRecord getOffsetRecord(long offset, boolean complete) {
    OffsetRecord offsetRecord = new OffsetRecord();
    offsetRecord.setOffset(offset);
    if (complete) {
      offsetRecord.complete();
    }
    return offsetRecord;
  }

  // Stole this data from Espresso tests, base64 encoded keys that were ripped off of EI boxes
  static final String KS_PASSWORD = "ThisIsNotTheProductionSecret";
  static final String STORAGE_KS_DATA = "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";
  static final String ROUTER_KS_DATA = "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";
  static final String CLIENT_KS_DATA = "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";
  static final String CORRUPT_KS_DATA = "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\n";
  static final String NON_COMPATIBLE_KS_DATA = "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";

  public static SSLEngineComponentFactory getRouterSslFactory(){
    return getSslFactory(ROUTER_KS_DATA, KS_PASSWORD);
  }

  public static SSLEngineComponentFactory getClientSslFactory(){
    return getSslFactory(CLIENT_KS_DATA, KS_PASSWORD);
  }

  private static SSLEngineComponentFactory getSslFactory(String keyStoreData, String keyStorePassword){
    SSLEngineComponentFactoryImpl.Config sslConfig = new SSLEngineComponentFactoryImpl.Config();
    sslConfig.setKeyStoreData(keyStoreData); // expires in 2027 or something
    sslConfig.setKeyStorePassword(keyStorePassword);
    sslConfig.setKeyStoreType("JKS");
    sslConfig.setTrustStoreFilePath("/etc/riddler/cacerts"); // exists on all boxes at LinkedIn
    sslConfig.setTrustStoreFilePassword("changeit");
    sslConfig.setSslEnabled(true);
    try {
      return new SSLEngineComponentFactoryImpl(sslConfig);
    } catch (Exception e) {
      throw new VeniceException("Failed to create test ssl factory", e);
    }
  }
}
