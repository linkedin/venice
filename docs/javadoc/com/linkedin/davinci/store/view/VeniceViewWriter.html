<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>VeniceViewWriter (venice API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: com.linkedin.davinci.store.view, class: VeniceViewWriter">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">com.linkedin.davinci.store.view</a></div>
<h1 title="Class VeniceViewWriter" class="title">Class VeniceViewWriter</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance"><a href="../../../venice/views/VeniceView.html" title="class in com.linkedin.venice.views">com.linkedin.venice.views.VeniceView</a>
<div class="inheritance">com.linkedin.davinci.store.view.VeniceViewWriter</div>
</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>Direct Known Subclasses:</dt>
<dd><code><a href="ChangeCaptureViewWriter.html" title="class in com.linkedin.davinci.store.view">ChangeCaptureViewWriter</a></code>, <code><a href="MaterializedViewWriter.html" title="class in com.linkedin.davinci.store.view">MaterializedViewWriter</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public abstract class </span><span class="element-name type-name-label">VeniceViewWriter</span>
<span class="extends-implements">extends <a href="../../../venice/views/VeniceView.html" title="class in com.linkedin.venice.views">VeniceView</a></span></div>
<div class="block">This class is kept separate from the VeniceView class to not leak certain concepts that
 currently exclusively reside in the server to other components. This class is created per
 <a href="../../kafka/consumer/LeaderFollowerStoreIngestionTask.html" title="class in com.linkedin.davinci.kafka.consumer"><code>LeaderFollowerStoreIngestionTask</code></a> per view and is
 invoked to processRecords in the <a href="../../kafka/consumer/ActiveActiveStoreIngestionTask.html" title="class in com.linkedin.davinci.kafka.consumer"><code>ActiveActiveStoreIngestionTask</code></a>
 as it's consumed from Kafka and after MergeConflict resolution has run. It's then invoked prior
 to committing to local persistent storage or local VT production in order to keep integrity of
 the data in various failure scenarios. This implies that repeat calls on the same data for
 processRecords can happen and there should be some protection from that being an issue in different
 view implementations.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static enum&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="VeniceViewWriter.ViewWriterType.html" class="type-name-link" title="enum class in com.linkedin.davinci.store.view">VeniceViewWriter.ViewWriterType</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>protected <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Boolean.html" title="class or interface in java.lang" class="external-link">Boolean</a>&gt;</code></div>
<div class="col-second even-row-color"><code><a href="#isNearlineProducerCompressionEnabled" class="member-name-link">isNearlineProducerCompressionEnabled</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>protected <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&gt;</code></div>
<div class="col-second odd-row-color"><code><a href="#nearlineProducerCountPerWriter" class="member-name-link">nearlineProducerCountPerWriter</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>protected final <a href="../../../venice/writer/VeniceWriterFactory.html" title="class in com.linkedin.venice.writer">VeniceWriterFactory</a></code></div>
<div class="col-second even-row-color"><code><a href="#veniceWriterFactory" class="member-name-link">veniceWriterFactory</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>protected final <a href="../../../venice/meta/Version.html" title="interface in com.linkedin.venice.meta">Version</a></code></div>
<div class="col-second odd-row-color"><code><a href="#version" class="member-name-link">version</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>protected final int</code></div>
<div class="col-second even-row-color"><code><a href="#versionNumber" class="member-name-link">versionNumber</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
<div class="inherited-list">
<h3 id="fields-inherited-from-class-com.linkedin.venice.views.VeniceView">Fields inherited from class&nbsp;com.linkedin.venice.views.<a href="../../../venice/views/VeniceView.html" title="class in com.linkedin.venice.views">VeniceView</a></h3>
<code><a href="../../../venice/views/VeniceView.html#props">props</a>, <a href="../../../venice/views/VeniceView.html#storeName">storeName</a>, <a href="../../../venice/views/VeniceView.html#VIEW_NAME_SEPARATOR">VIEW_NAME_SEPARATOR</a>, <a href="../../../venice/views/VeniceView.html#VIEW_STORE_PREFIX">VIEW_STORE_PREFIX</a>, <a href="../../../venice/views/VeniceView.html#viewParameters">viewParameters</a></code></div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(com.linkedin.davinci.config.VeniceConfigLoader,com.linkedin.venice.meta.Version,org.apache.avro.Schema,java.util.Map,com.linkedin.venice.writer.VeniceWriterFactory)" class="member-name-link">VeniceViewWriter</a><wbr>(<a href="../../config/VeniceConfigLoader.html" title="class in com.linkedin.davinci.config">VeniceConfigLoader</a>&nbsp;props,
 <a href="../../../venice/meta/Version.html" title="interface in com.linkedin.venice.meta">Version</a>&nbsp;version,
 org.apache.avro.Schema&nbsp;keySchema,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;extraViewParameters,
 <a href="../../../venice/writer/VeniceWriterFactory.html" title="class in com.linkedin.venice.writer">VeniceWriterFactory</a>&nbsp;veniceWriterFactory)</code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>abstract <a href="VeniceViewWriter.ViewWriterType.html" title="enum class in com.linkedin.davinci.store.view">VeniceViewWriter.ViewWriterType</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getViewWriterType()" class="member-name-link">getViewWriterType</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#processControlMessage(com.linkedin.venice.message.KafkaKey,com.linkedin.venice.kafka.protocol.KafkaMessageEnvelope,com.linkedin.venice.kafka.protocol.ControlMessage,int,com.linkedin.davinci.kafka.consumer.PartitionConsumptionState)" class="member-name-link">processControlMessage</a><wbr>(<a href="../../../venice/message/KafkaKey.html" title="class in com.linkedin.venice.message">KafkaKey</a>&nbsp;kafkaKey,
 <a href="../../../venice/kafka/protocol/KafkaMessageEnvelope.html" title="class in com.linkedin.venice.kafka.protocol">KafkaMessageEnvelope</a>&nbsp;kafkaMessageEnvelope,
 <a href="../../../venice/kafka/protocol/ControlMessage.html" title="class in com.linkedin.venice.kafka.protocol">ControlMessage</a>&nbsp;controlMessage,
 int&nbsp;partition,
 <a href="../../kafka/consumer/PartitionConsumptionState.html" title="class in com.linkedin.davinci.kafka.consumer">PartitionConsumptionState</a>&nbsp;partitionConsumptionState)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Called when the server encounters a control message.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>abstract <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#processRecord(java.nio.ByteBuffer,byte%5B%5D,int,java.util.Set,com.linkedin.venice.utils.lazy.Lazy)" class="member-name-link">processRecord</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a>&nbsp;newValue,
 byte[]&nbsp;key,
 int&nbsp;newValueSchemaId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&gt;&nbsp;viewPartitionSet,
 <a href="../../../venice/utils/lazy/Lazy.html" title="interface in com.linkedin.venice.utils.lazy">Lazy</a>&lt;org.apache.avro.generic.GenericRecord&gt;&nbsp;newValueProvider)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">To be called as a given ingestion task consumes each record.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>abstract <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#processRecord(java.nio.ByteBuffer,java.nio.ByteBuffer,byte%5B%5D,int,int,org.apache.avro.generic.GenericRecord,com.linkedin.venice.utils.lazy.Lazy)" class="member-name-link">processRecord</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a>&nbsp;newValue,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a>&nbsp;oldValue,
 byte[]&nbsp;key,
 int&nbsp;newValueSchemaId,
 int&nbsp;oldValueSchemaId,
 org.apache.avro.generic.GenericRecord&nbsp;replicationMetadataRecord,
 <a href="../../../venice/utils/lazy/Lazy.html" title="interface in com.linkedin.venice.utils.lazy">Lazy</a>&lt;org.apache.avro.generic.GenericRecord&gt;&nbsp;valueProvider)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">To be called as a given ingestion task consumes each record.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected <a href="../../../venice/writer/VeniceWriterOptions.Builder.html" title="class in com.linkedin.venice.writer">VeniceWriterOptions.Builder</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setProducerOptimizations(com.linkedin.venice.writer.VeniceWriterOptions.Builder)" class="member-name-link">setProducerOptimizations</a><wbr>(<a href="../../../venice/writer/VeniceWriterOptions.Builder.html" title="class in com.linkedin.venice.writer">VeniceWriterOptions.Builder</a>&nbsp;configBuilder)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">A store could have many views and to reduce the impact to write throughput we want to check and enable producer
 optimizations that can be configured at the store level.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-com.linkedin.venice.views.VeniceView">Methods inherited from class&nbsp;com.linkedin.venice.views.<a href="../../../venice/views/VeniceView.html" title="class in com.linkedin.venice.views">VeniceView</a></h3>
<code><a href="../../../venice/views/VeniceView.html#close(boolean)">close</a>, <a href="../../../venice/views/VeniceView.html#composeTopicName(int)">composeTopicName</a>, <a href="../../../venice/views/VeniceView.html#getStoreName(java.lang.String)">getStoreName</a>, <a href="../../../venice/views/VeniceView.html#getStoreNameFromViewStoreName(java.lang.String)">getStoreNameFromViewStoreName</a>, <a href="../../../venice/views/VeniceView.html#getTopicNamesAndConfigsForVersion(int)">getTopicNamesAndConfigsForVersion</a>, <a href="../../../venice/views/VeniceView.html#getViewNameFromViewStoreName(java.lang.String)">getViewNameFromViewStoreName</a>, <a href="../../../venice/views/VeniceView.html#getViewStoreName(java.lang.String,java.lang.String)">getViewStoreName</a>, <a href="../../../venice/views/VeniceView.html#getWriterClassName()">getWriterClassName</a>, <a href="../../../venice/views/VeniceView.html#getWriterOptionsBuilder(java.lang.String,com.linkedin.venice.meta.Version)">getWriterOptionsBuilder</a>, <a href="../../../venice/views/VeniceView.html#isViewStore(java.lang.String)">isViewStore</a>, <a href="../../../venice/views/VeniceView.html#isViewTopic(java.lang.String)">isViewTopic</a>, <a href="../../../venice/views/VeniceView.html#parseStoreAndViewFromViewTopic(java.lang.String)">parseStoreAndViewFromViewTopic</a>, <a href="../../../venice/views/VeniceView.html#parseStoreFromViewTopic(java.lang.String)">parseStoreFromViewTopic</a>, <a href="../../../venice/views/VeniceView.html#parseVersionFromViewTopic(java.lang.String)">parseVersionFromViewTopic</a>, <a href="../../../venice/views/VeniceView.html#validateConfigs(com.linkedin.venice.meta.Store)">validateConfigs</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="version">
<h3>version</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type"><a href="../../../venice/meta/Version.html" title="interface in com.linkedin.venice.meta">Version</a></span>&nbsp;<span class="element-name">version</span></div>
</section>
</li>
<li>
<section class="detail" id="versionNumber">
<h3>versionNumber</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">versionNumber</span></div>
</section>
</li>
<li>
<section class="detail" id="isNearlineProducerCompressionEnabled">
<h3>isNearlineProducerCompressionEnabled</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Boolean.html" title="class or interface in java.lang" class="external-link">Boolean</a>&gt;</span>&nbsp;<span class="element-name">isNearlineProducerCompressionEnabled</span></div>
</section>
</li>
<li>
<section class="detail" id="nearlineProducerCountPerWriter">
<h3>nearlineProducerCountPerWriter</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&gt;</span>&nbsp;<span class="element-name">nearlineProducerCountPerWriter</span></div>
</section>
</li>
<li>
<section class="detail" id="veniceWriterFactory">
<h3>veniceWriterFactory</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type"><a href="../../../venice/writer/VeniceWriterFactory.html" title="class in com.linkedin.venice.writer">VeniceWriterFactory</a></span>&nbsp;<span class="element-name">veniceWriterFactory</span></div>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(com.linkedin.davinci.config.VeniceConfigLoader,com.linkedin.venice.meta.Version,org.apache.avro.Schema,java.util.Map,com.linkedin.venice.writer.VeniceWriterFactory)">
<h3>VeniceViewWriter</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">VeniceViewWriter</span><wbr><span class="parameters">(<a href="../../config/VeniceConfigLoader.html" title="class in com.linkedin.davinci.config">VeniceConfigLoader</a>&nbsp;props,
 <a href="../../../venice/meta/Version.html" title="interface in com.linkedin.venice.meta">Version</a>&nbsp;version,
 org.apache.avro.Schema&nbsp;keySchema,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;extraViewParameters,
 <a href="../../../venice/writer/VeniceWriterFactory.html" title="class in com.linkedin.venice.writer">VeniceWriterFactory</a>&nbsp;veniceWriterFactory)</span></div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="processRecord(java.nio.ByteBuffer,java.nio.ByteBuffer,byte[],int,int,org.apache.avro.generic.GenericRecord,com.linkedin.venice.utils.lazy.Lazy)">
<h3>processRecord</h3>
<div class="member-signature"><span class="modifiers">public abstract</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">processRecord</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a>&nbsp;newValue,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a>&nbsp;oldValue,
 byte[]&nbsp;key,
 int&nbsp;newValueSchemaId,
 int&nbsp;oldValueSchemaId,
 org.apache.avro.generic.GenericRecord&nbsp;replicationMetadataRecord,
 <a href="../../../venice/utils/lazy/Lazy.html" title="interface in com.linkedin.venice.utils.lazy">Lazy</a>&lt;org.apache.avro.generic.GenericRecord&gt;&nbsp;valueProvider)</span></div>
<div class="block">To be called as a given ingestion task consumes each record. This is called prior to writing to a
 VT or to persistent storage.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>newValue</code> - the incoming fully specified value which hasn't yet been committed to Venice</dd>
<dd><code>oldValue</code> - the previous value which has already been locally committed to Venice for the given key</dd>
<dd><code>key</code> - the key of the record that designates newValue and oldValue</dd>
<dd><code>newValueSchemaId</code> - the schemaId of the incoming record</dd>
<dd><code>oldValueSchemaId</code> - the schemaId of the old record</dd>
<dd><code>replicationMetadataRecord</code> - the associated RMD for the incoming record.</dd>
<dd><code>valueProvider</code> - to provide the corresponding deserialized newValue for PUT and UPDATE or the old value for the
                      given key for DELETE.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="processRecord(java.nio.ByteBuffer,byte[],int,java.util.Set,com.linkedin.venice.utils.lazy.Lazy)">
<h3>processRecord</h3>
<div class="member-signature"><span class="modifiers">public abstract</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">processRecord</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/ByteBuffer.html" title="class or interface in java.nio" class="external-link">ByteBuffer</a>&nbsp;newValue,
 byte[]&nbsp;key,
 int&nbsp;newValueSchemaId,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&gt;&nbsp;viewPartitionSet,
 <a href="../../../venice/utils/lazy/Lazy.html" title="interface in com.linkedin.venice.utils.lazy">Lazy</a>&lt;org.apache.avro.generic.GenericRecord&gt;&nbsp;newValueProvider)</span></div>
<div class="block">To be called as a given ingestion task consumes each record. This is called prior to writing to a
 VT or to persistent storage.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>newValue</code> - the incoming fully specified value which hasn't yet been committed to Venice</dd>
<dd><code>key</code> - the key of the record that designates newValue and oldValue</dd>
<dd><code>newValueSchemaId</code> - the schemaId of the incoming record</dd>
<dd><code>viewPartitionSet</code> - set of view partitions this record should be processed to. This is used in NR
                                 pass-through when remote region leaders can forward record or chunks of a record
                                 to the correct view partitions without the need to perform chunk assembly or
                                 repartitioning.</dd>
<dd><code>newValueProvider</code> - to provide the deserialized new value</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getViewWriterType()">
<h3>getViewWriterType</h3>
<div class="member-signature"><span class="modifiers">public abstract</span>&nbsp;<span class="return-type"><a href="VeniceViewWriter.ViewWriterType.html" title="enum class in com.linkedin.davinci.store.view">VeniceViewWriter.ViewWriterType</a></span>&nbsp;<span class="element-name">getViewWriterType</span>()</div>
</section>
</li>
<li>
<section class="detail" id="processControlMessage(com.linkedin.venice.message.KafkaKey,com.linkedin.venice.kafka.protocol.KafkaMessageEnvelope,com.linkedin.venice.kafka.protocol.ControlMessage,int,com.linkedin.davinci.kafka.consumer.PartitionConsumptionState)">
<h3>processControlMessage</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">processControlMessage</span><wbr><span class="parameters">(<a href="../../../venice/message/KafkaKey.html" title="class in com.linkedin.venice.message">KafkaKey</a>&nbsp;kafkaKey,
 <a href="../../../venice/kafka/protocol/KafkaMessageEnvelope.html" title="class in com.linkedin.venice.kafka.protocol">KafkaMessageEnvelope</a>&nbsp;kafkaMessageEnvelope,
 <a href="../../../venice/kafka/protocol/ControlMessage.html" title="class in com.linkedin.venice.kafka.protocol">ControlMessage</a>&nbsp;controlMessage,
 int&nbsp;partition,
 <a href="../../kafka/consumer/PartitionConsumptionState.html" title="class in com.linkedin.davinci.kafka.consumer">PartitionConsumptionState</a>&nbsp;partitionConsumptionState)</span></div>
<div class="block">Called when the server encounters a control message. There isn't (today) a strict ordering
 on if the rest of the server alters it's state completely or not based on the incoming control message
 relative to the given view.

 Different view types may be interested in different control messages and act differently. The corresponding
 view writer should implement this method accordingly.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>kafkaKey</code> - the corresponding kafka key of this control message</dd>
<dd><code>kafkaMessageEnvelope</code> - the corresponding kafka message envelope of this control message</dd>
<dd><code>controlMessage</code> - the control message we're processing</dd>
<dd><code>partition</code> - the partition this control message was delivered to</dd>
<dd><code>partitionConsumptionState</code> - the pcs of the consuming node</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setProducerOptimizations(com.linkedin.venice.writer.VeniceWriterOptions.Builder)">
<h3>setProducerOptimizations</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="../../../venice/writer/VeniceWriterOptions.Builder.html" title="class in com.linkedin.venice.writer">VeniceWriterOptions.Builder</a></span>&nbsp;<span class="element-name">setProducerOptimizations</span><wbr><span class="parameters">(<a href="../../../venice/writer/VeniceWriterOptions.Builder.html" title="class in com.linkedin.venice.writer">VeniceWriterOptions.Builder</a>&nbsp;configBuilder)</span></div>
<div class="block">A store could have many views and to reduce the impact to write throughput we want to check and enable producer
 optimizations that can be configured at the store level. To change the producer optimization configs the ingestion
 task needs to be re-initialized. Meaning either a new version push or server restart after the store level config
 change and this is by design.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>configBuilder</code> - to be configured with the producer optimizations</dd>
<dt>Returns:</dt>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
