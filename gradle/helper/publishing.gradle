ext.publishing = [
    configureRegularArtifactPublishing: { currentProject, artifactName, sourceJar, testJar ->
      if (currentProject.version != project.DEFAULT_VERSION) {
        println "Will publish ${currentProject.path} at ${currentProject.group}:${artifactName}:${currentProject.version}"

        publishing {
          publications {
            "$artifactName"(MavenPublication) {
              groupId currentProject.group
              artifactId artifactName
              version currentProject.version

              from currentProject.components.java
              artifact sourceJar
              //  TODO: Enable after we have valid javadocs
              // artifact javadocJar
              artifact testJar

              //we strive to meet https://central.sonatype.org/pages/requirements.html
              pom {
                name = 'Venice'
                description = 'Derived Data Platform for planet-scale workloads'
                url = 'https://github.com/linkedin/venice'

                licenses {
                  license {
                    name = 'BSD 2-Clause'
                    url = 'https://raw.githubusercontent.com/linkedin/venice/master/LICENSE'
                  }
                }
                scm {
                  connection = 'scm:git:git://github.com:linkedin/venice.git'
                  developerConnection = 'scm:git:ssh://github.com:linkedin/venice.git'
                  url = 'https://github.com/linkedin/venice'
                }
              }
            }
          }

          //repositories inherited from parent build.gradle
        }
      }
    },

    configureShadowArtifactPublishing: { currentProject, artifactName, shadowJar, sourceJar, testJar ->
      if (currentProject.version != project.DEFAULT_VERSION) {
        def classifier = 'all'
        println "Will publish ${currentProject.path} at ${currentProject.group}:${artifactName}-${classifier}:${currentProject.version}"

        println ""

        publishing {
          publications {
            "$artifactName"(MavenPublication) {
              groupId currentProject.group
              artifactId "$artifactName"
              version currentProject.version

              artifact source: shadowJar, classifier: "$classifier"
              // TODO: Enable after we figure out getting the full source for shadow jars
              // artifact sourceJar
              // TODO: Enable after we have valid javadocs
              // artifact javadocJar

              //we strive to meet https://central.sonatype.org/pages/requirements.html
              pom {
                name = 'Venice'
                description = 'Derived Data Platform for planet-scale workloads'
                url = 'https://github.com/linkedin/venice'

                licenses {
                  license {
                    name = 'BSD 2-Clause'
                    url = 'https://raw.githubusercontent.com/linkedin/venice/master/LICENSE'
                  }
                }
                scm {
                  connection = 'scm:git:git://github.com:linkedin/venice.git'
                  developerConnection = 'scm:git:ssh://github.com:linkedin/venice.git'
                  url = 'https://github.com/linkedin/venice'
                }
              }
            }
          }

          //repositories inherited from parent build.gradle
        }
      }

    }
]
