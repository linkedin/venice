syntax = 'proto3';
package com.linkedin.venice.protocols.controller;


import "controller/ControllerGrpcRequestContext.proto";

option java_multiple_files = true;

service StoreGrpcService {
  rpc createStore(CreateStoreGrpcRequest) returns (CreateStoreGrpcResponse);
  rpc updateAclForStore(UpdateAclForStoreGrpcRequest) returns (UpdateAclForStoreGrpcResponse);
  rpc getAclForStore(GetAclForStoreGrpcRequest) returns (GetAclForStoreGrpcResponse);
  rpc deleteAclForStore(DeleteAclForStoreGrpcRequest) returns (DeleteAclForStoreGrpcResponse);
  rpc checkResourceCleanupForStoreCreation(ClusterStoreGrpcInfo) returns (ResourceCleanupCheckGrpcResponse) {}
  rpc validateStoreDeleted(ValidateStoreDeletedGrpcRequest) returns (ValidateStoreDeletedGrpcResponse);
  rpc listStores(ListStoresGrpcRequest) returns (ListStoresGrpcResponse);

  // Schema operations
  rpc getAllValueSchema(GetAllValueSchemaGrpcRequest) returns (GetAllValueSchemaGrpcResponse);
}

message CreateStoreGrpcRequest {
  ClusterStoreGrpcInfo storeInfo = 1;
  string keySchema = 2;
  string valueSchema = 3;
  optional string owner = 4;
  optional bool isSystemStore = 5;
  optional string accessPermission = 6;
}

message CreateStoreGrpcResponse {
  ClusterStoreGrpcInfo storeInfo = 1;
  string owner = 2;
}

message UpdateAclForStoreGrpcRequest {
  ClusterStoreGrpcInfo storeInfo = 1;
  string accessPermissions = 3;
}

message UpdateAclForStoreGrpcResponse {
  ClusterStoreGrpcInfo storeInfo = 1;
}

message GetAclForStoreGrpcRequest {
  ClusterStoreGrpcInfo storeInfo = 1;
}

message GetAclForStoreGrpcResponse {
  ClusterStoreGrpcInfo storeInfo = 1;
  string accessPermissions = 2;
}

message DeleteAclForStoreGrpcRequest {
  ClusterStoreGrpcInfo storeInfo = 1;
}

message DeleteAclForStoreGrpcResponse {
  ClusterStoreGrpcInfo storeInfo = 1;
}

message ResourceCleanupCheckGrpcResponse {
  ClusterStoreGrpcInfo storeInfo = 1;
  bool hasLingeringResources = 2;
  optional string description = 3;
}

message ValidateStoreDeletedGrpcRequest {
  ClusterStoreGrpcInfo storeInfo = 1;
}

message ValidateStoreDeletedGrpcResponse {
  ClusterStoreGrpcInfo storeInfo = 1;
  bool storeDeleted = 2;
  optional string reason = 3;
}

message ListStoresGrpcRequest {
  string clusterName = 1;
  optional bool includeSystemStores = 2;
  optional string storeConfigNameFilter = 3;
  optional string storeConfigValueFilter = 4;
}

message ListStoresGrpcResponse {
  string clusterName = 1;
  repeated string storeNames = 2;
}

message GetAllValueSchemaGrpcRequest {
  ClusterStoreGrpcInfo storeInfo = 1;
}

message SchemaGrpcInfo {
  int32 id = 1;
  string schemaStr = 2;
  optional int32 derivedSchemaId = 3;
}

message GetAllValueSchemaGrpcResponse {
  ClusterStoreGrpcInfo storeInfo = 1;
  repeated SchemaGrpcInfo schemas = 2;
  int32 superSetSchemaId = 3;
}