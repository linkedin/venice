pluginManagement {
  repositories {
    // TODO: remove this before open-sourcing
    ivy {
      url 'http://artifactory.corp.linkedin.com:8081/artifactory/release/'
      allowInsecureProtocol = true
      patternLayout {
        ivy '[organisation]/[module]/[revision]/[module]-[revision].ivy'
        artifact '[organisation]/[module]/[revision]/[artifact]-[revision](-[classifier]).[ext]'
        m2compatible = true
      }
      metadataSources.ignoreGradleMetadataRedirection = true
    }
  }
}

plugins {
  id 'com.gradle.enterprise' version '3.10'
}

gradleEnterprise {
  server = System.getProperty('buildScanServer', 'Set systemProp.buildScanServer in ~/.gradle/gradle.properties')
  buildScan {
    value 'GIT_BRANCH', 'git rev-parse --abbrev-ref HEAD'.execute().text.trim()
    value 'GIT_COMMIT', 'git rev-parse --verify HEAD'.execute().text.trim()
    def status = 'git diff --name-status origin/master'.execute().text.trim()
    if (status) {
      tag 'dirty'
      value 'GIT_STATUS', status
    }
  }
}

dependencyResolutionManagement {
  repositories.addAll(pluginManagement.repositories)
}

include 'clients:da-vinci-client'
include 'clients:hadoop-to-venice-bridge'
include 'clients:venice-admin-tool'
include 'clients:venice-client'
include 'internal:venice-common'
include 'internal:venice-compatibility-test'
include 'internal:venice-consumer'
include 'services:venice-controller'
include 'services:venice-router'
include 'clients:venice-samza'
include 'internal:venice-client-common'
include 'services:venice-server'
include 'internal:venice-test-common'
include 'clients:venice-thin-client'
